> 샘플데이터v2 EDA 분석 기반 규칙 매핑표 v1 설계 규칙

---

# 규칙 매핑표v1 설계 규칙

## 1. 기본 설계 구조

| 구분 | 변수명 | 설명 |
| --- | --- | --- |
| **입력 (Input)** | `location`, `db_band`, `goal` | 사용자의 환경(장소), 소음 수준, 심리적 목표 |
| **출력 (Output)** | `bpm_min, bpm_max, energy_min, energy_max, mood, genre_primary, genre_secondary, vocal, playlist_seed` | 음악의 물리·정서적 속성 및 추천 시드. `playlist_seed`는 `mood + genre_primary + goal` 조합의 문자열 |

---

## 2. 1차 결정 변수 : Goal (심리적 목표 중심)

| Goal | BPM | Energy | Mood | Genre | Vocal | 특징 |
| --- | --- | --- | --- | --- | --- | --- |
| **active** | 110–120 | 0.65–0.80 | upbeat / energetic | pop, edm, funk | vocal-heavy | 빠른 템포, 자극적 리듬 |
| **focus** | 75–90 | 0.40–0.55 | calm / focused | lo-fi, instrumental hiphop, ambient | instrumental | 집중 유지 중심 |
| **relax** | 60–75 | 0.30–0.45 | chill / mellow | jazz, acoustic, r&b | light-vocal / instrumental | 여유로운 분위기 |
| **reading** | 58–65 | 0.30–0.35 | soft / neutral | piano, classical, lo-fi | instrumental | 배경음악 중심 |
| **neutral** | 60–62 | 0.32–0.34 | neutral | ambient, acoustic | mixed | 중립값 (Fallback 기본형) |
| **meditate** | 55–60 | 0.25–0.32 | serene / noise-masking | ambient drone, binaural | no-vocal | 저주파 반복형 명상음 |
| **sleep** | 55 | 0.20–0.22 | soothing / lull | ambient, white noise | no-vocal | 수면 유도용 안정 사운드 |

**근거**
- BPM, Energy, Mood는 샘플 EDA 기준으로 설정  
- Genre는 EDA + 음악 심리학 + Spotify/Brain.fm 패턴 분석 종합  
- Vocal은 집중 방해 여부, 감정 자극 강도, 목표의 목적성 고려 설정

---

## 3. 2차 보정 변수 : Decibel (소음 수준)

EDA결과 66–80 dB 구간에서 마스킹 효과가 두드러짐에 따라, BPM·Energy·Vocal을 단계적으로 보정.

| 소음 구간 (dB) | BPM 보정 | Energy 보정   | Vocal 보정   | 해석               |
| ---------- | ------ | ----------- | ---------- | ---------------- |
| **0–35**   | −5     | −0.05       | –          | 정적 환경, 템포/에너지 낮춤 |
| **36–50**  | −2     | −0.02       | –          | 기본값 근접           |
| **51–65**  | ±0     | ±0          | –          | 일상 수준 (baseline) |
| **66–80**  | +5~+10 | +0.05~+0.10 | vocal 허용 ↑ | 백노이즈 마스킹 효과 극대화  |
| **81–100** | −5     | −0.05       | vocal ↓    | 과도한 소음 완충 필요     |

> 100 dB 초과 값은 신호대잡음비가 극히 낮아 의미 해석 왜곡 → 상한 클램핑 권장 -> 100초과는 이상치로 설정

*예시 적용*
Focus(기준 80 BPM) + 70 dB → 90 BPM, light vocal 허용
Meditate(기준 58 BPM) + 70 dB → 55–58 BPM 유지, no-vocal 유지

---

## 4. 3차 보정 변수 : Location (장소 특성)

장소는 Mood·Genre·Vocal 톤 보정 중심으로 작동 (공간 반향/주파수 특성 반영).

| 장소          | 환경 특성       | Mood 보정                | Genre 보정            | Vocal 보정    | 예시                      |
| ----------- | ----------- | ---------------------- | ------------------- | ----------- | ----------------------- |
| **library** | 정적, 반향 적음   | calm / soft            | piano, lo-fi        | no-vocal    | Study Beats, Piano Calm |
| **home**    | 중립적 환경      | neutral                | lo-fi, acoustic     | mixed       | Evening Acoustic        |
| **office**  | 사람소리, 잔향 약간 | focus / chill          | jazz, instrumental  | light-vocal | Workday Jazz            |
| **cafe**    | 백노이즈, 활기    | chill / easy           | lo-fi, acoustic pop | vocal ↑     | Lo-Fi Cafe              |
| **outdoor** | 불규칙 소음      | chill / energetic      | ambient pop, indie  | mixed       | City Flow               |
| **subway**  | 고·저주파 혼합    | noise-masking / upbeat | electronic, ambient | no-vocal    | Ambient Journey         |

*보정 규칙 요약*
1. Mood 기본값/오버라이드
library → calm / home → neutral / office → focus / cafe·outdoor → chill
subway에서 meditate는 noise-masking 오버라이드

2. Genre 보정(추가 시드)
공간 특성에 맞는 악기/질감 장르 1–2개 추가해 검색 시드 안정화

3. Vocal 규칙 (장소×목표)
library·subway: 보컬 억제 강화
office: light-vocal 허용
cafe: active는 vocal-heavy, 그 외는 light/inst 중심
기타 장소: 기본 보컬 정책 유지

> 총괄: Goal이 1차 결정, Decibel은 강도 슬라이더, Location은 톤 보정

---

## 5. 복합 규칙 적용 로직

> Final Rule = Goal 기반값 + Decibel 보정 + Location 보정

BPM = Goal 기준 ± 소음 보정
Energy = Goal 기준 ± 소음 보정
Mood = Goal 중심, Location으로 보정
Genre = Goal 중심, Location으로 세부 장르 보완
Vocal = Goal × Decibel × Location 복합 결정
Playlist = Mood + Genre 기반 시드 자동 선택

---

## 6. 예시 매핑

| location    | decibel_range | goal     | bpm | energy | mood          | genre            | vocal        | playlist         |
| ----------- | ------------- | -------- | --- | ------ | ------------- | ---------------- | ------------ | ---------------- |
| **cafe**    | 66–80         | focus    | 88  | 0.50   | chill         | lo-fi jazz       | light-vocal  | Lo-Fi Jazz Focus |
| **library** | 36–50         | relax    | 63  | 0.33   | calm          | piano / acoustic | instrumental | Study & Calm     |
| **subway**  | 81–100        | meditate | 55  | 0.25   | noise-masking | ambient drone    | no-vocal     | Ambient Journey  |
| **outdoor** | 51–65         | active   | 115 | 0.70   | energetic     | indie pop        | vocal-heavy  | City Run Mix     |

---

## 7. 예외 및 Fallback 규칙

| 상황                     | 처리 규칙                             |
| ---------------------- | --------------------------------- |
| 목표 누락                  | `goal = neutral` (표준값 적용)         |
| dB 이상치 (0 미만 / 100 초과) | 경계값으로 **클램핑**                     |
| 규칙 미적용 조합              | `Playlist = "Ambient Essentials"` |
| Focus/Active + 81+dB   | BPM 상승 제한 (**+10 이하**)            |
| Meditate/Sleep         | BPM 고정, `vocal = no`              |

---

### 8. 최종 설계 요약

핵심 의존 변수: Goal (1차 결정)
보정 변수: Decibel (강도 슬라이더), Location (음색·무드 조정)
출력 항목: bpm, energy, mood, genre, vocal, playlist
커버리지: 6 장소 × 7 목표 = 42 조합 100%
Fallback: 0건 유지, 완전 매칭 구조